<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8"/>
    <meta name="google-site-verification" content="oTZL-J0lpqoMMfQvrhFBaPfG1gtsswFKz1RzHoMLgbo" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">

    <!-- Le styles -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../css/asciidoctor.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/prettify.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/01a45d7f35.js" crossorigin="anonymous"></script>

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../../favicon.ico">


    <title>Mémo Gradle</title>

  </head>
  <body onload="prettyPrint()">
    <div id="wrap">

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/"><i class="fa-solid fa-house"></i></a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li><a href="../../formations/index.html">Formations</a></li>



            </ul>


            <ul class="nav navbar-nav">
                <li><a href="mailto:talaria.school@gmail.com" target="_blank"><i class="fa-regular fa-envelope fa-lg"></i></a></li>
                <li><a href="https://github.com/cheroliv" target="_blank"><i class="fa-brands fa-github fa-lg"></i></a></li>
                <li><a href="../../feed.xml"><i class="fa fa-rss fa-lg"></i></a></li>
            </ul>

        </div><!--/.nav-collapse -->
    </div>
</div>
<div class="container">

	<div class="page-header">
		<h1>Mémo Gradle</h1>
	</div>

	<p><em>23 mai 2022</em></p>

	<p><div class="listingblock">
<div class="title">Afficher l&#8217;aide</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew --help</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Définir la propriété système de la JVM : <code>-D, --system-prop</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew -Dmyprop=myvalue
#ou
./gradlew --system-prop myvalue</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Définir la propriété du projet pour le build script : <code>-Pmyprop=myvalue</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew -Pmyprop=myvalue
#ou
./gradlew --project-prop myvalue</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Spécifie le répertoire de démarrage de Gradle. La valeur par défaut est le répertoire actuel.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew -p ~/src/next_startup
#ou
./gradlew --project-dir ~/src/next_startup</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Surcharger la property 'param_component' par la ligne de commande :</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew -Pparam_component=CUSTOM_VALUE</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Ajouter un dossier à un source-set dans un projet normal avec le kotlin dsl</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">sourceSets {
    getByName("test"){
        java.srcDir("src/scripts/groovy")
    }
    getByName("test"){
        java.srcDir("src/scripts/kscript")
    }
    getByName("test"){
        java.srcDir("src/test/javascript")
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Ajouter un dossier à un source-set dans un projet android avec le groovy dsl</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">android {
    sourceSets {
        main.java.srcDirs += "src/main/../../../../ceelo/domain/src/main/java/"
        test.java.srcDirs += "src/test/../../../../ceelo/domain/src/test/java/"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Éviter de construire et tester un sous module</div>
<p>gradle build -x :excluded-module:check -x :excluded-module:assemble -x :excluded-module:build</p>
</div>
<div class="listingblock">
<div class="title">Déplacer des fichiers</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("moveWebappNode") {
    doLast {
        ant.withGroovyBuilder {
            "move"(
                "webapp/node_modules" to "$rootDir/webapp-src/node_modules",
            )
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Tar un dossier</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register&lt;Tar&gt;("tarWebapp") {
    dependsOn("moveWebappNpm")
    group = WEBAPP
    description = "tar webapp"
    doLast {
        setOf(
            "build",
            "target",
            "node_modules"
        ).forEach { dir -&gt; exclude { it.name .dir } }
        archiveFileName.set("webapp.tar")
        destinationDirectory.set(File("${rootDir.absolutePath}$sep$WEBAPP_SRC"))
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Afficher les dépendances d&#8217;un build</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("printDependencies") {
    description = "print project dependencies"
    group = WEBAPP
    doLast {
        println("${project.name} dependencies")
        mutableMapOf&lt;String, Map&lt;String, String&gt;&gt;(
            "buildDependencies" to buildDependencies,
            "domainDeps" to domainDeps,
            "domainTestDeps" to domainTestDeps,
        ).apply { putAll(appModules) }
            .forEach { module -&gt;
                if (module.value.isNotEmpty()) {
                    println("${module.key}:")
                    module.value.forEach { println(dependency(it)) }
                    println()
                }
            }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Exemple d&#8217;utilisation de reduce : concaténation d&#8217;une list dans un string</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">tasks.register("printWebappSrc") {
    description = "print webapp sources"
    group = WEBAPP
    doLast {
        webAppSrc
            .reduce { acc, s -&gt; "$acc\n\t$s" }
            .run { println("$WEBAPP_SRC: $this\n") }
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Récupérer la description d&#8217;une tache en particulier</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">.\gradlew.bat -q help --task foo</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Pour lancer une tache depuis le workingDir root, alors préfixer la tache pas un <code>:</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">.\gradlew.bat :foo</code></pre>
</div>
</div></p>

	<section id="disqus_thread"></section>
	<script type="text/javascript">
		var disqus_identifier = 'blog/2022/0047_memo_gradle_post.html';

		(({disqus_shortname, document}) => {
			injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
			injectScript('//' + disqus_shortname + '.disqus.com/count.js');

			function injectScript(url) {
				const s = document.createElement('script');
				s.async = true;
				s.src = url;
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(s);
			}
		})({'disqus_shortname': 'TODO', 'document': document});
	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	<hr/>
		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
          <b>@Talaria.Formation | <a rel="À propos" href="../../about.html">À propos</a> | &copy; 2019-2024 | Licence Creative Commons BY-NC-SA
              <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
                <img alt="Creative Commons License"
                        style="border-width:0"
                        src="http://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/>
          </b>
          <br/>
      </div>
    </div>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../../js/jquery.min.js"></script>
    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/prettify.js"></script>
    
  </body>
</html>
